{"version":3,"sources":["../js/city.js"],"names":["SYPEX_URL","GLAVPUNKT_URL","selectedCity","cities","getReguest","url","callback","xhr","XMLHttpRequest","open","send","onreadystatechange","status","statusText","readyState","call","responseText","setCity","res","$","parseJSON","city","name_ru","setTimeout","console","log","html","setCityManual","fancybox","close","setCities","getCityList","val","counter","i","length","name","toLowerCase","indexOf","jQuery","document","ready","on"],"mappings":"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","sourcesContent":["const SYPEX_URL = 'http://api.sypexgeo.net/';\r\nGLAVPUNKT_URL = 'https://glavpunkt.ru/api/get_rf_cities'\r\nlet selectedCity, cities;\r\n\r\n\r\nfunction getReguest(url, callback) {\r\n    let xhr = new XMLHttpRequest();\r\n\r\n    xhr.open('GET', url);\r\n    xhr.send();\r\n\r\n    xhr.onreadystatechange = function () {\r\n        if (xhr.status != 200) {\r\n            return xhr.statusText;\r\n\r\n        } else {\r\n            if (xhr.readyState == 4) {\r\n                //let res = $.parseJSON(xhr.responseText);\r\n\r\n                //callback.call(res.city.name_ru);\r\n                callback.call(xhr.responseText);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\nfunction setCity() {\r\n    let res = $.parseJSON(this)\r\n    selectedCity = res.city.name_ru;\r\n    setTimeout(() => {\r\n        console.log(this)\r\n    }, 1000);\r\n\r\n    $('#city-link').html(selectedCity);\r\n}\r\n\r\nfunction setCityManual(city) {\r\n    $('#city-link').html(city);\r\n    $.fancybox.close();\r\n}\r\n\r\nfunction setCities() {\r\n    cities = $.parseJSON(this);\r\n    console.log($.parseJSON(this));\r\n    getCityList()\r\n}\r\n\r\nfunction getCityList() {\r\n    let val = $('#city-input').val(),\r\n        counter = 0,\r\n        html = '<ul>';\r\n    for (let i = 0; i < cities.length; i++) {\r\n        if (cities[i].name.toLowerCase().indexOf(val.toLowerCase()) >= 0 && counter < 5) {\r\n            console.log(val, cities[i].name, i)\r\n            html += `<li><button class=\"city-click\" onclick=\"setCityManual('${cities[i].name}')\">` + cities[i].name + '</button></li>';\r\n            counter++\r\n        }\r\n    }\r\n\r\n    html += '</ul>';\r\n    $('#search_result').html(html);\r\n\r\n}\r\n\r\njQuery(document).ready(($) => {\r\n    console.log('BE READY');\r\n    getReguest(SYPEX_URL, setCity);\r\n\r\n    $(document).on('keyup', '#city-input', function () {\r\n        let val = $(this).val();\r\n        if (!cities)\r\n            getReguest(GLAVPUNKT_URL, setCities)\r\n        else\r\n            getCityList();\r\n    })\r\n})"],"file":"city.js"}