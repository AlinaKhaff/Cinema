{"version":3,"sources":["../js/feedback.js"],"names":["name1Field","document","querySelector","parentNode","email1Field","selectPlace","getElementById","reviewField","form1","ERROR_CLASS_NAME1","FOCUCED_CLASS_NAME1","SELECT_SELECTED1","initalizeField","field","input1","getElementsByTagName","fieldError1","reset","value","classList","remove","innerText","clearError","addEventListener","add","addError","errorText","getValue","focus","name1FieldUtils","email1FieldUtils","reviewFieldUtils","handleSubmit","event","preventDefault","name1Value","email1Value","reviewValue","indexOf","data","FormData","$","ajax","url","type","dataType","success","msg","html","fancybox","open","src","error","hide","showErrors","cache","contentType","processData","each","i","responseJSON","errors","attr","parent","closest","lenght","addClass","j","append"],"mappings":"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","sourcesContent":["const name1Field = document.querySelector('#block08-form input[name=\"name\"]').parentNode;\r\nconst email1Field = document.querySelector('#block08-form input[name=\"email\"]').parentNode;\r\nconst selectPlace = document.getElementById('place-numbers')\r\nconst reviewField = document.querySelector('#block08-form textArea[name=\"review\"]').parentNode;\r\nconst form1 = document.getElementById('feedback-form');\r\n\r\nconst ERROR_CLASS_NAME1 = 'st-input1_error';\r\nconst FOCUCED_CLASS_NAME1 = 'st-input1_focused';\r\nconst SELECT_SELECTED1 = 'input-select-selected';\r\n\r\nfunction initalizeField(field) {\r\n    const input1 = (field.getElementsByTagName('input')[0]) ? (field.getElementsByTagName('input')[0]) : (field.getElementsByTagName('textArea')[0])\r\n    const fieldError1 = field.querySelector('.st-input1__error-msg');\r\n\r\n    reset();\r\n\r\n    input1.value = '';\r\n    field.classList.remove(ERROR_CLASS_NAME1);\r\n    field.classList.remove(FOCUCED_CLASS_NAME1);\r\n    fieldError1.innerText = '';\r\n\r\n\r\n\r\n    function clearError() {\r\n        field.classList.remove(ERROR_CLASS_NAME1);\r\n        fieldError1.innerText = '';\r\n    }\r\n\r\n\r\n    input1.addEventListener('focus', function () {\r\n        field.classList.add(FOCUCED_CLASS_NAME1);\r\n    })\r\n\r\n    input1.addEventListener('blur', () => {\r\n        if (!input1.value) {\r\n            field.classList.remove(FOCUCED_CLASS_NAME1);\r\n        }\r\n    })\r\n    input1.addEventListener('input', () => {\r\n        clearError();\r\n    })\r\n\r\n    function reset() {\r\n        input1.value = '';\r\n        field.classList.remove(ERROR_CLASS_NAME1);\r\n        field.classList.remove(FOCUCED_CLASS_NAME1);\r\n        clearError();\r\n    }\r\n\r\n    return {\r\n        addError(errorText) {\r\n            field.classList.add(ERROR_CLASS_NAME1);\r\n            fieldError1.innerText = errorText;\r\n        },\r\n        getValue() {\r\n            return input1.value\r\n        },\r\n        focus() {\r\n            input1.focus()\r\n        },\r\n        reset: reset\r\n\r\n    }\r\n}\r\nconst name1FieldUtils = initalizeField(name1Field);\r\nconst email1FieldUtils = initalizeField(email1Field);\r\nconst reviewFieldUtils = initalizeField(reviewField);\r\n\r\n\r\nselectPlace.addEventListener('change', () => {\r\n    selectPlace.classList.add('input-select-selected');\r\n})\r\n\r\n\r\nfunction handleSubmit(event) {\r\n    event.preventDefault();\r\n\r\n    const name1Value = name1FieldUtils.getValue();\r\n    const email1Value = email1FieldUtils.getValue();\r\n    const reviewValue = reviewFieldUtils.getValue();\r\n\r\n\r\n\r\n    if (!name1Value) {\r\n        name1FieldUtils.addError('Необходимо указать имя');\r\n        return;\r\n\r\n    }\r\n    if (!email1Value) {\r\n        email1FieldUtils.addError('Необходимо указать email');\r\n        return;\r\n\r\n    } else {\r\n\r\n        if (email1Value.indexOf('@') === -1 && email1Value.indexOf('.') === -1) {\r\n            email1FieldUtils.addError('Невалидный  email');\r\n            return;\r\n        }\r\n    }\r\n\r\n    if (selectPlace.value === 'none') {\r\n        selectPlace.classList.add(ERROR_CLASS_NAME1);\r\n        return;\r\n\r\n    }\r\n    if (!reviewValue) {\r\n        reviewFieldUtils.addError('Необходимо добавить отзыв');\r\n        return;\r\n    }\r\n\r\n\r\n    // const data = {\r\n    //     name: name1Value,\r\n    //     email: email1Value,\r\n    //     select: selectPlace.value\r\n    // };\r\n    const data = new FormData(document.getElementById('feedback-form'));\r\n\r\n    $.ajax({\r\n        url: 'http://study.xeol.ru/api/new_order',\r\n        type: 'post',\r\n        data: data,\r\n        dataType: 'json',\r\n        success: function (msg) {\r\n            $('.success-result').html(msg.success);\r\n            $.fancybox.open({\r\n                src: '.modal-success',\r\n                type: 'inline',\r\n            });\r\n        },\r\n        error: function (msg) {\r\n            $('.ajax-loader').hide();\r\n            showErrors(msg)\r\n        },\r\n        cache: false,\r\n        contentType: false,\r\n        processData: false\r\n    })\r\n\r\n    function showErrors(msg) {\r\n        $('#feedback-form input, #feedback-form select').each(function () {\r\n            for (let i in msg.responseJSON.errors) {\r\n                if (i == $(this).attr('name')) {\r\n                    let parent = $(this).closest('.st-input1');\r\n                    if (!parent.lenght)\r\n                        parent = $(this).closest('.input-wrap');\r\n                    if (!parent.lenght)\r\n                        parent = $(this).closest('.st-checkbox');\r\n                    parent.addClass('st-input1_error')\r\n                    for (let j in msg.responseJSON.errors[i]) {\r\n                        parent.append('<p class=\"st-input_error-msg\">' + msg.responseJSON.errors[i][j] + '</p>');\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    // const url = new URL('http://inno-ijl.ru/multystub/stc-21-03/feedback');\r\n    // url.search = new URLSearchParams(data).toString();\r\n\r\n    // fetch(url.toString())\r\n    //     .then(data => data.json())\r\n    //     .then((data) => {\r\n\r\n    //         name1FieldUtils.reset();\r\n    //         email1FieldUtils.reset();\r\n    //         reviewFieldUtils.reset();\r\n    //         selectPlace.value = 'none';\r\n    //         selectPlace.classList.remove(SELECT_SELECTED);\r\n    //     });\r\n\r\n}\r\n\r\nform1.addEventListener('submit', handleSubmit);"],"file":"feedback.js"}